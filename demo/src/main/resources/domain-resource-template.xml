<domain application-root="${com.sun.aas.instanceRoot}/applications" version="89"
        log-root="${com.sun.aas.instanceRoot}/logs">
    <resources>
        <jdbc-resource pool-name="__TimerPool" object-type="system-admin" jndi-name="jdbc/__TimerPool"></jdbc-resource>
        <jdbc-connection-pool datasource-classname="org.apache.derby.jdbc.EmbeddedXADataSource" name="__TimerPool"
                              res-type="javax.sql.XADataSource">
            <property name="databaseName" value="${com.sun.aas.instanceRoot}/lib/databases/ejbtimer"></property>
            <property name="connectionAttributes" value=";create=true"></property>
        </jdbc-connection-pool>

        <jdbc-resource pool-name="DerbyPool" object-type="system-all" jndi-name="jdbc/__default"></jdbc-resource>
        <jdbc-connection-pool is-isolation-level-guaranteed="false"
                              datasource-classname="org.apache.derby.jdbc.ClientDataSource" name="DerbyPool"
                              res-type="javax.sql.DataSource">
            <property name="PortNumber" value="15432"></property>
            <property name="Password" value="APP"></property>
            <property name="User" value="APP"></property>
            <property name="serverName" value="localhost"></property>
            <property name="DatabaseName" value="sun-appserv-samples"></property>
            <property name="connectionAttributes" value=";create=true"></property>
        </jdbc-connection-pool>

        <jdbc-resource pool-name="jdbc/updateservice/raw-repo/pool"
                       jndi-name="jdbc/updateservice/raw-repo-readonly"></jdbc-resource>
        <jdbc-resource pool-name="jdbc/updateservice/raw-repo/pool"
                       jndi-name="jdbc/updateservice/raw-repo-writable"></jdbc-resource>
        <jdbc-connection-pool datasource-classname="org.postgresql.ds.PGSimpleDataSource"
                              name="jdbc/updateservice/raw-repo/pool" res-type="javax.sql.DataSource">
            <property name="driverClass" value="org.postgresql.Driver"></property>
            <property name="ServerName" value="${postgresql.host}"></property>
            <property name="PortNumber" value="${postgresql.port}"></property>
            <property name="DatabaseName" value="${postgresql.rawrepo.name}"></property>
            <property name="User" value="${postgresql.rawrepo.user}"></property>
            <property name="Password" value="${postgresql.rawrepo.passwd}"></property>
            <property name="BinaryTransfer" value="true"></property>
            <property name="Ssl" value="false"></property>
            <property name="ProtocolVersion" value="0"></property>
            <property name="TcpKeepAlive" value="false"></property>
            <property name="SocketTimeout" value="0"></property>
            <property name="LoginTimeout" value="0"></property>
            <property name="UnknownLength" value="2147483647"></property>
            <property name="PrepareThreshold" value="5"></property>
        </jdbc-connection-pool>

        <jdbc-resource pool-name="jdbc/updateservice/holdingitems/pool"
                       jndi-name="jdbc/updateservice/holdingitems"></jdbc-resource>
        <jdbc-connection-pool datasource-classname="org.postgresql.ds.PGPoolingDataSource"
                              name="jdbc/updateservice/holdingitems/pool" res-type="javax.sql.DataSource">
            <property name="driverClass" value="org.postgresql.Driver"></property>
            <property name="ServerName" value="${postgresql.host}"></property>
            <property name="PortNumber" value="${postgresql.port}"></property>
            <property name="DatabaseName" value="${postgresql.holdings.name}"></property>
            <property name="User" value="${postgresql.holdings.user}"></property>
            <property name="Password" value="${postgresql.holdings.passwd}"></property>
            <property name="BinaryTransfer" value="true"></property>
            <property name="Ssl" value="false"></property>
            <property name="ProtocolVersion" value="0"></property>
            <property name="TcpKeepAlive" value="false"></property>
            <property name="SocketTimeout" value="0"></property>
            <property name="LoginTimeout" value="0"></property>
            <property name="UnknownLength" value="2147483647"></property>
            <property name="PrepareThreshold" value="5"></property>
        </jdbc-connection-pool>

        <custom-resource factory-class="org.glassfish.resources.custom.factory.PropertiesFactory"
                         res-type="java.util.Properties" jndi-name="${updateservice.settings.jndi.name}">
            <property name="solr.url" value="${updateservice.settings.solr.url}"></property>
            <property name="forsrights.url" value="${updateservice.settings.forsrights.url}"></property>
            <property name="auth.product.name" value="${updateservice.settings.auth.product.name}"></property>
            <property name="auth.use.ip" value="${updateservice.settings.auth.use.ip}"></property>
            <property name="javascript.basedir" value="${updateservice.settings.javascript.basedir}"></property>
            <property name="javascript.install.name" value="<domain-name>"></property>
            <property name="rawrepo.provider.id" value="${updateservice.settings.rawrepo.provider.id}"></property>
        </custom-resource>

        <custom-resource factory-class="org.glassfish.resources.custom.factory.PrimitivesAndStringFactory"
                         res-type="java.lang.String" jndi-name="update-log/logback">
            <property name="value"
                      value="${updateservice.basedir}/update-logback-include.xml"></property>
        </custom-resource>

        <connector-connection-pool resource-adapter-name="jmsra" max-pool-size="250" steady-pool-size="1"
                                   name="jms/__defaultConnectionFactory-Connection-Pool"
                                   connection-definition-name="javax.jms.ConnectionFactory"></connector-connection-pool>
        <connector-resource pool-name="jms/__defaultConnectionFactory-Connection-Pool" object-type="system-all-req"
                            jndi-name="jms/__defaultConnectionFactory"></connector-resource>
        <managed-scheduled-executor-service object-type="system-all"
                                            jndi-name="concurrent/__defaultManagedScheduledExecutorService"></managed-scheduled-executor-service>
        <managed-executor-service object-type="system-all"
                                  jndi-name="concurrent/__defaultManagedExecutorService"></managed-executor-service>
        <context-service object-type="system-all" jndi-name="concurrent/__defaultContextService"></context-service>
        <managed-thread-factory object-type="system-all"
                                jndi-name="concurrent/__defaultManagedThreadFactory"></managed-thread-factory>
    </resources>

    <servers>
        <server config-ref="server-config" name="server">
            <application-ref ref="__admingui" virtual-servers="__asadmin"></application-ref>
            <application-ref ref="updateservice" virtual-servers="server"></application-ref>
            <resource-ref ref="jms/__defaultConnectionFactory"></resource-ref>
            <resource-ref ref="jdbc/__TimerPool"></resource-ref>
            <resource-ref ref="jdbc/__default"></resource-ref>

            <resource-ref ref="jdbc/updateservice/raw-repo-readonly"></resource-ref>
            <resource-ref ref="jdbc/updateservice/raw-repo-writable"></resource-ref>
            <resource-ref ref="jdbc/updateservice/holdingitems"></resource-ref>
            <resource-ref ref="updateservice/settings"></resource-ref>
            <resource-ref ref="update-log/logback"></resource-ref>

            <resource-ref ref="concurrent/__defaultManagedScheduledExecutorService"></resource-ref>
            <resource-ref ref="concurrent/__defaultManagedExecutorService"></resource-ref>
            <resource-ref ref="concurrent/__defaultContextService"></resource-ref>
            <resource-ref ref="concurrent/__defaultManagedThreadFactory"></resource-ref>
        </server>
    </servers>

    <system-property name="UPDATE_LOGBACK_FILENAME" value="${deploy.directory}/glassfish/updateservice/logs/<domain-name>"></system-property>

</domain>